---
layout: post
title: "AHP+模糊综合评价法"
subtitle: "study AHP FUZZY pandas numpy"
author: "guanlili"
header-img: "img/about-bg.jpg"
header-img-credit: "@WebdesignerDepot"
header-img-credit-href: "medium.com/@WebdesignerDepot/poll-should-css-become-more-like-a-programming-language-c74eb26a4270"
header-mask: 0.4
tags:
  - 层次分析法
  - 模糊综合评价法
  - AHP
  - numpy
  - pandas
  - 学习笔记
---


## 前言

最近接了个某研究院的项目，需求是通过层次分析法（AHP）计算权重，然后通过各个指标的权重进行模糊综合评价，笔者在此进行学习总结，烦请各位批评指正。

## 模糊综合评价法（FUZZY）

### 模糊综合评价简介

模糊综合评价是一种综合评价的方法，是我目前所接触到的使用数学方法对一个给定问题的评价方法，该评价方法杜绝了原始的非“黑”即“白”的评价方式，模糊评价方法着重研究“认知不确定”一类的问题，其研究对象具有“内涵明确，外延不明确”的特点。我们知道，一个事物往往需要用多个指标刻画其本质与特征，并且人们对一个事物的评价又往往不是简单的好与不好，而是采用模糊语言分为不同程度的评语。由于评价等级之间的关系是模糊的，没有绝对明确的界限，因此具有模糊性。显而易见，对于这类模糊评价问题，利用经典的评价方法存在着不合理性。

换种人能听懂的话说就是，我想买个自行车，这个自行车在评价是有很多指标如：重量、刚性、刹车、舒适度、变速手感、车架几何……并且在这些指标里面并不是说就存在完美的车将这些特点都包揽，如：破风车架有良好的破风效果但是对于爬坡车架比重量较大，碟刹的刹车剪切力是车架左侧，U型刹的刹车剪切力在车架中管处其车架刚性会弱一点，刚性弱会影响摇车手感……那么为了更好的挑选出适合自己的自行车，我们就可以通过模糊综合评价的方法，最终挑选出在合理预算中适合自己的那台车。

## 层次分析法（AHP）

### AHP定义与原理

AHP层次分析法（运筹学理论）是一种解决多目标复杂问题的**定性和定量相结合**进行计算决策权重的研究方法，它的应用遍及各个领域。

层次分析法的基本思路与人对一个复杂的决策问题的思维、判断过程大体上是一样的，非常人性化。打个比方：假期旅游有ABC三个地方都想去该怎么选呢？选择困难症的孩纸是不是难以抉择。AHP告诉你，洒洒水啦。首先，你要根据诸如景色、费用和居住、饮食、旅途条件等一些准则去反复比较这3个候选地点。你可以根据自己的实际情况来确定每个因素在你心里的重要程度，如果你经济宽绰、醉心旅游，自然特别看重景色条件，而平素俭朴或手头拮据的人则会优先考虑费用，中老年旅游者还会对居住、饮食等条件寄以较大关注。其次，你会就每一个准则将3个地点进行对比，譬如A景色最好，B次之；B费用最低，C次之；C居住等条件较好等等。最后，你要将这两个层次的比较判断进行综合，在A、B、C中确定哪个作为最佳地点。这样便可以将感性转化为理性，非常的科学！

### AHP计算方法

原理（feihua）讲完了来看下具体怎么操作。

#### 建立层次结构模型

在深入分析问题的基础上，将决策的目标、考虑的因素和决策对象按相关关系分为最高层、中间层和最低层。

· 最高层（目标层）：决策的目的、要解决的问题
· 中间层（准则层或指标层）：考虑的因素、决策的准则
· 最底层（方案层）：决策时的备选方案

#### 构造判断（比较）矩阵

为实现定性向定量转化需要有定量的标度，此过程需要结合专家打分最终得到判断矩阵表格。
在确定各层次各因素之间的权重时，如果只是定性的结果(就是我认为景色占80%，费用10%等等)，则常常不容易被别人接受，因此Santy等人提出：一致矩阵法，即：

1. 不把所有因素放在一起比较，而是两两比较；
2. 对此时采用相对尺度，以尽可能减少性质不同的诸因素相互比较的困难，以提高准去性；比较矩阵是表示本层所有因素针对上一层某一个因素(准侧或目标)的相对重要性的比较。比如对旅游景点选择的4个影响因素（分别是景色，门票，交通和拥挤度）进行评价（即专家评价），最终得出四个影响因素的权重。采用1-5分标度法（也或者1-9标度法），即比如门票相对景色更加重要，此时门票打3分，那么景色相对于门票就是取其倒数1/3即0.3333分。交通相对于景色来更重要为2分，景色相对于交通就是0.5分等。如果A因素相对B因素非常重要，此时打5分（最高5分），那么B因素相对于A因素就是1/5即0.2分

|        | 景色 | 门票   | 交通 | 拥挤度 |

| 景色   | 1    | 0.3333 | 0.5  | 0.5    |

| 门票   | 3    | 1      | 2    | 2      |

| 交通   | 2    | 0.5    | 1    | 2      |

| 拥挤度 | 2    | 0.5    | 0.5  | 1      |

#### 层次单排序及一致性检验

由于无论是AHP还是FUZZY最主要的运算无外乎矩阵的运算，所以笔者在此学习通过Numpy进行矩阵相关计算，学习Pandas进行数据的处理。